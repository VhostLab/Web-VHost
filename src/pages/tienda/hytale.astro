---
import MainLayout from "../../layouts/MainLayout.astro";
import "../../styles/global.css";
import HeroTienda from "../../components/HeroTienda.astro";
import FAQSection from "../../components/FAQSection.astro";
import SupportBanner from "../../components/SupportBanner.astro";
import ServerMap from "../../components/ServerMap.astro";
import ConsoleSection from "../../components/ConsoleSection.astro";
import DedicatedSection from "../../components/DedicatedSection.astro";
import HytaleBudgetlCards from "../../components/hytaleBudgetCards.astro";
import HytaleNormalCards from "../../components/hytaleNormalCards.astro";
import HytalePremiumCards from "../../components/hytalePremiumCards.astro";

// --- DATOS DE LOS PLANES (EDITAR AQUÍ) ---

const products = [
    {
        key: "inicio",
        type: "Plan Inicio",
        ram: "4GB",
        disk: "20 GB", // <--- EDITA EL DISCO AQUÍ
        price: "3,99€", // <--- EDITA EL PRECIO AQUÍ
        // He puesto una imagen genérica que funciona. Cambia esta URL por la tuya cuando quieras.
        img: "https://via.placeholder.com/150/0000FF/808080?text=Hytale+Inicio",
        url: "https://billing.vhost.tech/products/hytale/inicio",
        bgClass: "bg-gradient-to-br from-blue-900 to-slate-900",
        recommended: false,
    },
    {
        key: "avanzado",
        type: "Plan Avanzado",
        ram: "8GB",
        disk: "40 GB", // <--- EDITA EL DISCO AQUÍ
        price: "7,99€", // <--- EDITA EL PRECIO AQUÍ
        img: "https://via.placeholder.com/150/FF4500/FFFFFF?text=Hytale+Avanzado",
        url: "https://billing.vhost.tech/products/hytale/avanzado",
        bgClass: "bg-gradient-to-br from-orange-900 to-red-900",
        recommended: true,
    },
    {
        key: "pro",
        type: "Plan Profesional",
        ram: "16GB",
        disk: "80 GB", // <--- EDITA EL DISCO AQUÍ
        price: "15,99€", // <--- EDITA EL PRECIO AQUÍ
        img: "https://via.placeholder.com/150/008000/FFFFFF?text=Hytale+Pro",
        url: "https://billing.vhost.tech/products/hytale/pro",
        bgClass: "bg-gradient-to-br from-emerald-900 to-teal-900",
        recommended: false,
    },
];

const faqs = [
    {
        question: "¿Cuándo se activará mi servidor?",
        answer: "Estamos en fase de pre-reserva. Tu servidor se activará automáticamente el día del lanzamiento.",
    },
    {
        question: "¿Soportan Scripting y Mods?",
        answer: "Sí, todos nuestros planes permiten acceso completo para scripts y la instalación de mods compatibles con Hytale.",
    },
    {
        question: "¿Qué métodos de pago aceptan?",
        answer: "Aceptamos tarjetas de crédito, PayPal y Bizum.",
    },
    {
        question: "¿Puedo mejorar mi plan (Upgrade) más tarde?",
        answer: "Sí, puedes aumentar la RAM y el disco de tu servidor en cualquier momento desde el área de clientes pagando solo la diferencia.",
    },
    {
        question: "¿Incluyen protección Anti-DDoS?",
        answer: "Por supuesto. Todos nuestros servidores cuentan con protección Anti-DDoS profesional optimizada para juegos (Game Protection).",
    },
    {
        question: "¿Dónde están ubicados los servidores?",
        answer: "Nuestros servidores están alojados en centros de datos en España para garantizar la mejor latencia y estabilidad.",
    },
    {
        question: "¿Tengo acceso a los archivos del servidor?",
        answer: "Sí, tendrás acceso completo vía SFTP y a través del gestor de archivos de nuestro panel de control.",
    },
    {
        question: "¿Ofrecen soporte técnico?",
        answer: "Contamos con un equipo de soporte 24/7 disponible a través de Discord y tickets para ayudarte con cualquier problema.",
    },
    {
        question: "¿Qué panel de control utilizan?",
        answer: "Utilizamos un panel intuitivo y moderno (Pterodactyl modificado) que facilita la gestión, copias de seguridad y configuración.",
    },
    {
        question: "¿Existe política de devolución?",
        answer: "Sí, ofrecemos una garantía de reembolso durante las primeras 48 horas si el servicio no cumple con tus expectativas.",
    },
];
---

<MainLayout
    title="Hytale Hosting"
    description="Reserva tu servidor de Hytale en Vhost."
    image="https://vhost.tech/SEO/hytale-preview.webp"
    url="https://vhost.tech/tienda/hytale"
>
    <HeroTienda
        titulo="Hytale Hosting"
        imagenFondo="/images/tienda/hytale/hytale-wallpaper.jpg"
    />
    <section class="relative bg-[#0b0b0b] text-white py-12 px-4">
        <!-- Título, subtítulo y enlace -->
        <div class="text-center mt-12 mb-6">
            <h2 class="text-3xl font-poppins font-semibold text-white">
                Comparar tipos de planes
            </h2>
            <p class="text-gray-300 font-poppins mt-1">
                Selecciona una gama para ver sus características y precios.
            </p>
            <a
                href="#gamas"
                id="scroll-to-gamas"
                class="mt-2 inline-block text-secondary underline font-poppins transition-colors duration-300 hover:text-[#e07600]"
            >
                Ver características
            </a>
        </div>

        <div class="relative z-10">
            <!-- Interruptor tipo toggle 3 posiciones -->
            <div class="flex justify-center my-6">
                <div
                    class="relative inline-flex bg-[#1a1a1a] rounded-full text-lg font-poppins font-semibold text-white w-[21rem] h-12 items-center"
                    role="tablist"
                    aria-label="Selector de planes"
                >
                    <!-- Indicador deslizante (1/3 del ancho) -->
                    <div
                        id="toggle-indicator"
                        class="absolute top-0 left-0 h-full w-1/3 rounded-full bg-[#fc7c04] transition-all duration-300 z-0"
                    >
                    </div>

                    <!-- Botón Budget -->
                    <button
                        id="btn-budget"
                        role="tab"
                        aria-selected="true"
                        class="relative z-10 w-1/3 h-full rounded-full transition-colors duration-300 focus:outline-none"
                    >
                        Budget
                    </button>

                    <!-- Botón Normal -->
                    <button
                        id="btn-normal"
                        role="tab"
                        aria-selected="false"
                        class="relative z-10 w-1/3 h-full rounded-full transition-colors duration-300 focus:outline-none text-white"
                    >
                        Normal
                    </button>

                    <!-- Botón Premium -->
                    <button
                        id="btn-premium"
                        role="tab"
                        aria-selected="false"
                        class="relative z-10 w-1/3 h-full rounded-full transition-colors duration-300 focus:outline-none text-white"
                    >
                        Premium
                    </button>
                </div>
            </div>

            <!-- Secciones -->
            <div
                id="budget-section"
                class="transition-opacity duration-200 ease-in-out opacity-100"
            >
                <HytaleBudgetlCards />
                <DedicatedSection />
            </div>

            <div
                id="normal-section"
                class="transition-opacity duration-200 ease-in-out opacity-0 hidden"
            >
                <HytaleNormalCards />
                <DedicatedSection />
            </div>

            <div
                id="premium-section"
                class="transition-opacity duration-200 ease-in-out opacity-0 hidden"
            >
                <HytalePremiumCards />
                <DedicatedSection />
            </div>
        </div>
    </section>

    <ConsoleSection />
    <ServerMap />

    <SupportBanner />
    <FAQSection
        items={faqs}
        inviteLink="https://discord.gg/Ykr85wevrj"
        backgroundClass="101010"
    />
    <script is:inline>
        const btnBudget = document.getElementById("btn-budget");
        const btnNormal = document.getElementById("btn-normal");
        const btnPremium = document.getElementById("btn-premium");
        const toggleIndicator = document.getElementById("toggle-indicator");

        const budgetSection = document.getElementById("budget-section");
        const normalSection = document.getElementById("normal-section");
        const premiumSection = document.getElementById("premium-section");

        const scrollLink = document.getElementById("scroll-to-gamas");
        const DURATION = 200;

        const plans = ["budget", "normal", "premium"];
        const sections = {
            budget: budgetSection,
            normal: normalSection,
            premium: premiumSection,
        };
        const buttons = {
            budget: btnBudget,
            normal: btnNormal,
            premium: btnPremium,
        };

        function fadeTo(showEl, ...hideEls) {
            hideEls.forEach((el) => {
                el.classList.remove("opacity-100");
                el.classList.add("opacity-0");
                setTimeout(() => {
                    el.classList.add("hidden");
                }, DURATION);
            });

            showEl.classList.remove("hidden");
            // Forzar dos frames para transición suave
            requestAnimationFrame(() => {
                requestAnimationFrame(() => {
                    showEl.classList.remove("opacity-0");
                    showEl.classList.add("opacity-100");
                });
            });
        }

        function setActive(plan) {
            // Mover indicador: 0%, 33.333%, 66.666%
            const index = plans.indexOf(plan);
            const leftPercent = index * (100 / 3);
            toggleIndicator.style.left = leftPercent + "%";

            // Actualizar secciones
            const toShow = sections[plan];
            const toHide = plans
                .filter((p) => p !== plan)
                .map((p) => sections[p]);
            fadeTo(toShow, ...toHide);

            // Actualizar colores y aria-selected
            plans.forEach((p) => {
                const btn = buttons[p];
                const selected = p === plan;
                btn.setAttribute("aria-selected", selected ? "true" : "false");
                if (selected) {
                    btn.classList.add("text-black");
                    btn.classList.remove("text-white");
                } else {
                    btn.classList.remove("text-black");
                    btn.classList.add("text-white");
                }
            });
        }

        // Eventos de click
        btnBudget.addEventListener("click", () => setActive("budget"));
        btnNormal.addEventListener("click", () => setActive("normal"));
        btnPremium.addEventListener("click", () => setActive("premium"));

        // Navegación con teclado (izq/der) para accesibilidad
        const order = [btnBudget, btnNormal, btnPremium];
        order.forEach((btn, i) => {
            btn.addEventListener("keydown", (e) => {
                if (e.key === "ArrowRight") {
                    e.preventDefault();
                    order[(i + 1) % order.length].focus();
                    order[(i + 1) % order.length].click();
                } else if (e.key === "ArrowLeft") {
                    e.preventDefault();
                    order[(i - 1 + order.length) % order.length].focus();
                    order[(i - 1 + order.length) % order.length].click();
                }
            });
        });

        // Estado inicial
        setActive("budget");

        // Scroll suave a "gamas"
        scrollLink.addEventListener("click", (e) => {
            e.preventDefault();
            const gamasSection = document.getElementById("gamas");
            if (gamasSection) {
                gamasSection.scrollIntoView({ behavior: "smooth" });
            }
        });
    </script>
</MainLayout>
